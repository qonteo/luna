
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Descriptor extraction API &#8212; Luna python server v.2.2.2 documentation</title>
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Matching API" href="matching.html" />
    <link rel="prev" title="Lists API" href="lists.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>Luna python server v.2.2.2 documentation</span></a></h1>
        <h2 class="heading"><span>Descriptor extraction API</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="lists.html">Lists API</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="matching.html">Matching API</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="module-luna_api.app.rest_handlers.photo_handler">
<span id="descriptor-extraction-api"></span><span id="extract-label"></span><h1>Descriptor extraction API<a class="headerlink" href="#module-luna_api.app.rest_handlers.photo_handler" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="luna_api.app.rest_handlers.photo_handler.GetterPhotoHandler">
<em class="property">class </em><code class="descclassname">luna_api.app.rest_handlers.photo_handler.</code><code class="descname">GetterPhotoHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/luna_api/app/rest_handlers/photo_handler.html#GetterPhotoHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#luna_api.app.rest_handlers.photo_handler.GetterPhotoHandler" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="luna_api.app.rest_handlers.photo_handler.GetterPhotoHandler.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>photo_id</em>, <em>thumbnail</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/luna_api/app/rest_handlers/photo_handler.html#GetterPhotoHandler.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#luna_api.app.rest_handlers.photo_handler.GetterPhotoHandler.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive descriptor portrait.
If plug-in is activated, portrait is received by plug-in</p>
<dl class="post">
<dt id="post--storage-portraits-id">
<code class="descname">POST </code><code class="descname">/storage/portraits/{id}</code><a class="headerlink" href="#post--storage-portraits-id" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>thumbnail</strong> – type of thumbnail</li>
<li><strong>photo_id</strong> – descriptor id</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Example request</strong>:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Request Headers:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><em>LUNA-Request-Id</em> – request id</li>
<li><a class="reference external" href="https://tools.ietf.org/html/rfc7235#section-4.2">Authorization</a> – basic authorization</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>or</strong></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Request Headers:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><em>X-Auth-Token</em> – ‘16fd2706-8baf-433b-82eb-8c7fada847da’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Example response</strong>:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Request Headers:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://tools.ietf.org/html/rfc7231#section-3.1.1.5">Content-Type</a> – ‘image/jpeg’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Error messages are returned in following format <a class="reference internal" href="handlers.html#server_error"><code class="xref json json-object docutils literal notranslate"><span class="pre">server_error</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.4">403 Forbidden</a> – Forbidden, luna-image-store and plug-ins are disabled.</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.5">404 Not Found</a> – Portrait not found.</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.1">500 Internal Server Error</a> – Internal server error.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</dd></dl>

<dl class="class">
<dt id="luna_api.app.rest_handlers.photo_handler.PhotoHandler">
<em class="property">class </em><code class="descclassname">luna_api.app.rest_handlers.photo_handler.</code><code class="descname">PhotoHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/luna_api/app/rest_handlers/photo_handler.html#PhotoHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#luna_api.app.rest_handlers.photo_handler.PhotoHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Handler to receive images for extract. To work with handler you must authorize and account must be active</p>
<dl class="method">
<dt id="luna_api.app.rest_handlers.photo_handler.PhotoHandler.get">
<code class="descname">get</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/luna_api/app/rest_handlers/photo_handler.html#PhotoHandler.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#luna_api.app.rest_handlers.photo_handler.PhotoHandler.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Resource to get all descriptors.</p>
<dl class="post">
<dt id="post--storage-descriptors?page=1&amp;page_size=10">
<code class="descname">POST </code><code class="descname">/storage/descriptors?page=1&amp;page_size=10</code><a class="headerlink" href="#post--storage-descriptors?page=1&page_size=10" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Optparam page:</th><td class="field-body">A number of page. Minimum 1, default 1.</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Optparam page_size:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">Descriptors count on page.  Minimum 1, maximum 100, default 10.</td>
</tr>
</tbody>
</table>
<p><strong>Example request</strong>:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Request Headers:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><em>LUNA-Request-Id</em> – request id</li>
<li><a class="reference external" href="https://tools.ietf.org/html/rfc7235#section-4.2">Authorization</a> – basic authorization</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>or</strong></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Request Headers:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><em>X-Auth-Token</em> – ‘16fd2706-8baf-433b-82eb-8c7fada847da’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Example response</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">Ok</span>
<span class="na">Vary</span><span class="o">:</span> <span class="l">Accept</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
<span class="na">LUNA-Request-Id</span><span class="o">:</span> <span class="l">1516179740,c06887a2</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> – list of descriptors and number of descriptors are             received successfully.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="object">
<dt id="descriptors_json">
<!--[descriptors_json]--><code class="descname">descriptors_json</code><a class="headerlink" href="#descriptors_json" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Object Properties:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>descriptors</strong> (_list_(<a class="reference internal" href="handlers.html#descriptor"><code class="xref json json-object docutils literal notranslate"><span class="pre">descriptor</span></code></a>)) – descriptor list</li>
<li><strong>count</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#int" title="Python Integer"><em>int</em></a>) – number of descriptors</li>
</ul>
</td>
</tr>
</tbody>
</table>
<strong>JSON Example</strong><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;descriptors&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;124487bb-86e2-4295-8714-3488b78d8e75&quot;</span><span class="p">,</span>
            <span class="nt">&quot;person_id&quot;</span><span class="p">:</span> <span class="s2">&quot;6efa2429-9afd-4d2a-ae48-2eea2878b8f8&quot;</span><span class="p">,</span>
            <span class="nt">&quot;last_update&quot;</span><span class="p">:</span> <span class="s2">&quot;2006-05-04T23:59:55&quot;</span><span class="p">,</span>
            <span class="nt">&quot;lists&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;babbc806-8177-4484-b210-7c551e53a8cb&quot;</span><span class="p">,</span>
                <span class="s2">&quot;2fa3e682-55bf-48e0-b6f2-800005afca64&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ba26d7af-0bc6-4832-bc89-c62c897bead5&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;a8c6f944-fac0-4ec8-9947-7d5bed6e236b&quot;</span><span class="p">,</span>
            <span class="nt">&quot;person_id&quot;</span><span class="p">:</span> <span class="s2">&quot;7a2f528b-4dd2-4b92-9d36-b8743ee8cec2&quot;</span><span class="p">,</span>
            <span class="nt">&quot;last_update&quot;</span><span class="p">:</span> <span class="s2">&quot;1971-05-21T05:51:11&quot;</span><span class="p">,</span>
            <span class="nt">&quot;lists&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;6cf0b3e0-fdf5-4d49-a92c-4567b8b47ddf&quot;</span><span class="p">,</span>
                <span class="s2">&quot;bbc4103a-55c6-4022-a80f-0f4d89bd9d37&quot;</span><span class="p">,</span>
                <span class="s2">&quot;02e8975a-42ea-49ed-b7ee-dea4a557c422&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;47074f56-171f-48e7-ab5e-7cc133d18bd3&quot;</span><span class="p">,</span>
            <span class="nt">&quot;person_id&quot;</span><span class="p">:</span> <span class="s2">&quot;ccd778dc-4bff-43e3-b87a-6bf88719b8a5&quot;</span><span class="p">,</span>
            <span class="nt">&quot;last_update&quot;</span><span class="p">:</span> <span class="s2">&quot;2011-04-11T08:30:31&quot;</span><span class="p">,</span>
            <span class="nt">&quot;lists&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;1022d70a-c8c7-4a04-aa38-e40794de6c0c&quot;</span><span class="p">,</span>
                <span class="s2">&quot;f54f6f2f-b885-4126-9b66-291a965e8959&quot;</span><span class="p">,</span>
                <span class="s2">&quot;03891d72-91c3-4d72-a4b5-7586edb0fdeb&quot;</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;count&quot;</span><span class="p">:</span> <span class="mi">354</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<p>Error messages are returned in following format <a class="reference internal" href="handlers.html#server_error"><code class="xref json json-object docutils literal notranslate"><span class="pre">server_error</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.1">500 Internal Server Error</a> – internal server error</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="luna_api.app.rest_handlers.photo_handler.PhotoHandler.on_finish">
<code class="descname">on_finish</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/luna_api/app/rest_handlers/photo_handler.html#PhotoHandler.on_finish"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#luna_api.app.rest_handlers.photo_handler.PhotoHandler.on_finish" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to send statistics. Called, when account has already received answer.</p>
</dd></dl>

<dl class="method">
<dt id="luna_api.app.rest_handlers.photo_handler.PhotoHandler.post">
<code class="descname">post</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/luna_api/app/rest_handlers/photo_handler.html#PhotoHandler.post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#luna_api.app.rest_handlers.photo_handler.PhotoHandler.post" title="Permalink to this definition">¶</a></dt>
<dd><p>Request for descriptor extraction from photo.  Request is forwarded to LUNA, so input parameters are the same.
After extraction all descriptors are added to database, answer from LUNA is received
(if other is not set in parameters).</p>
<dl class="post">
<dt id="post--storage-descriptors?estimate_attributes=1&amp;estimate_quality=1&amp;quality_threshold=1&amp;warped_image=1&amp;extract_descriptor=1&amp;extract_exif=1">
<code class="descname">POST </code><code class="descname">/storage/descriptors?estimate_attributes=1&amp;estimate_quality=1&amp;quality_threshold=1&amp;warped_image=1&amp;extract_descriptor=1&amp;extract_exif=1</code><a class="headerlink" href="#post--storage-descriptors?estimate_attributes=1&estimate_quality=1&quality_threshold=1&warped_image=1&extract_descriptor=1&extract_exif=1" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Optparam estimate_attributes:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><p class="first">Whether to estimate face attributes from the image.</p>
<p>The attributes are stored in attributes object per face. Type: boolean, default: false.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Optparam estimate_emotions:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first">Whether to estimate emotions from the image.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Optparam quality_threshold:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><p class="first last">Whether to estimate face image quality from the image. The estimated quality
value is a floating point probability in [0..1] range.</p>
</td>
</tr>
</tbody>
</table>
<p>The quality is stored in quality parameter per face. See also quality_threshold. Type: boolean, default:
false.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Optparam estimate_quality:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><p class="first">If estimate_quality parameter is set to 1, it is possible to apply a threshold
check to each estimation. All face detections with quality below the threshold
will be ignored and no descriptors will be extracted out of them. The function
will proceed as usual with all the remaining detections (if left).</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Optparam warped_image:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><dl class="first docutils">
<dt>Whether input image is a warped or arbitrary one. Exact image warping algorithm</dt>
<dd><p class="first last">is proprietary and this flag is intended for VisionLabs front-end tools.</p>
</dd>
</dl>
<p>The warped image has the following properties:</p>
<blockquote>
<div><ul class="simple">
<li>it’s size is always 250x250 pixels</li>
</ul>
<ul class="simple">
<li>it’s always in RGB color format</li>
<li>it always contains just a single face</li>
<li>the face is always centered and rotated so that imaginary line between the eyes is horizontal.</li>
</ul>
</div></blockquote>
<p>Type: boolean, default: false.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Optparam extract_descriptor:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first docutils">
<dt>Whether to extract face descriptor(s). Useful when face descriptor is not</dt>
<dd><p class="first last">actually required and only face detection bounding rectangle (with optional
attributes and quality estimation) is enough. Note, that in this case face
structure will lack the member id.</p>
</dd>
</dl>
<p>Type: boolean, default: true.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Optparam estimate_head_pose:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><dl class="first docutils">
<dt>Whether to estimate head pose from the image.</dt>
<dd><p class="first last"><em>Not supported with warped images (see `warped_image` parameter).</em></p>
</dd>
</dl>
<p>Type: boolean, default: false.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Optparam pitch__lt:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first docutils">
<dt>Pitch threshold. For all the faces with estimated pitch that’s more than threshold do not extract descriptor.</dt>
<dd><p class="first last">Threshold must be in degrees, in the interval [0,180]. Otherwise, threshold is not taken into account.</p>
</dd>
</dl>
<p>Type: float, maximum: 180, minimum: 0</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Optparam yaw__lt:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><dl class="first docutils">
<dt>Yaw threshold. For all the faces with estimated yaw that’s more than threshold do not extract descriptor.</dt>
<dd><p class="first last">Threshold must be in degrees, in the interval [0,180]. Otherwise, threshold is not taken into account.</p>
</dd>
</dl>
<p>Type: float, maximum: 180, minimum: 0</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Optparam roll__lt:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first docutils">
<dt>Roll threshold. For all the faces with estimated roll that’s more than threshold do not extract descriptor.</dt>
<dd><p class="first last">Threshold must be in degrees, in the interval [0,180]. Otherwise, threshold is not taken into account.</p>
</dd>
</dl>
<p>Type: float, maximum: 180, minimum: 0</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Optparam extract_exif:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first">Whether to extract EXIF meta information from the input image.</p>
<p>Exact output will vary since there are no mandatory requirements to both authoring software and digital              cameras how to write the data.</p>
<p class="last">This function will only parse the tags and output their names and values as is. Please refer to              JEITA CP-3451 EXIF specification for details.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Example request</strong>:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Request Headers:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><em>LUNA-Request-Id</em> – request id</li>
<li><a class="reference external" href="https://tools.ietf.org/html/rfc7235#section-4.2">Authorization</a> – basic authorization</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>or</strong></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Request Headers:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><em>X-Auth-Token</em> – ‘16fd2706-8baf-433b-82eb-8c7fada847da’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>You must specify Content-Type.</p>
<p>If image is sent:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Request Headers:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://tools.ietf.org/html/rfc7231#section-3.1.1.5">Content-Type</a> – ‘image/jpeg’, ‘image/png’, ‘image/bmp’, ‘image/tiff’, ‘image/gif’, 
‘image/x-portable-pixmap’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>If descriptor is sent:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Request Headers:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://tools.ietf.org/html/rfc7231#section-3.1.1.5">Content-Type</a> – ‘application/x-vl-face-descriptor’, ‘application/x-vl-xpk’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>For data in base64 is sent:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Request Headers:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://tools.ietf.org/html/rfc7231#section-3.1.1.5">Content-Type</a> – ‘image/x-jpeg-base64’, ‘application/x-vl-face-descriptor-base64’,
‘application/x-vl-xpk-base64’,
‘image/x-windows-bmp-base64’, ‘image/x-png-base64’, ‘image/x-portable-pixmap-base64’,
‘image/x-bmp-base64”, ‘image/x-tiff-base64’, ‘image/x-gif-base64’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Example response</strong>:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Vary</span><span class="o">:</span> <span class="l">Accept</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
<span class="na">LUNA-Request-Id</span><span class="o">:</span> <span class="l">1516179740,c06887a2</span>
</pre></div>
</div>
<dl class="object">
<dt id="extract_result">
<!--[extract_result]--><code class="descname">extract_result</code><a class="headerlink" href="#extract_result" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Object Properties:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>faces</strong> (_list_(<a class="reference internal" href="handlers.html#extract_one_descriptor"><code class="xref json json-object docutils literal notranslate"><span class="pre">extract_one_descriptor</span></code></a>)) – faces, which were extracted</li>
<li><strong>exif</strong> (<a class="reference internal" href="handlers.html#exif"><code class="xref json json-object docutils literal notranslate"><span class="pre">exif</span></code></a>) – Select image EXIF tags. See CIPA DC-008-2016 for details. Tag to string conversions                  are handled by libEXIF.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<strong>JSON Example</strong><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;faces&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;f4df0694-01e8-4f51-9c40-fe4d8cbcebd4&quot;</span><span class="p">,</span>
            <span class="nt">&quot;rect&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;height&quot;</span><span class="p">:</span> <span class="mi">7890</span><span class="p">,</span>
                <span class="nt">&quot;width&quot;</span><span class="p">:</span> <span class="mi">665</span><span class="p">,</span>
                <span class="nt">&quot;x&quot;</span><span class="p">:</span> <span class="mi">559</span><span class="p">,</span>
                <span class="nt">&quot;y&quot;</span><span class="p">:</span> <span class="mi">9791</span>
            <span class="p">},</span>
            <span class="nt">&quot;rectISO&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;height&quot;</span><span class="p">:</span> <span class="mi">9887</span><span class="p">,</span>
                <span class="nt">&quot;width&quot;</span><span class="p">:</span> <span class="mi">4441</span><span class="p">,</span>
                <span class="nt">&quot;x&quot;</span><span class="p">:</span> <span class="mi">9071</span><span class="p">,</span>
                <span class="nt">&quot;y&quot;</span><span class="p">:</span> <span class="mi">9556</span>
            <span class="p">},</span>
            <span class="nt">&quot;score&quot;</span><span class="p">:</span> <span class="mf">0.17083999514579773</span><span class="p">,</span>
            <span class="nt">&quot;quality&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;light&quot;</span><span class="p">:</span> <span class="mf">0.6018808400258422</span><span class="p">,</span>
                <span class="nt">&quot;dark&quot;</span><span class="p">:</span> <span class="mf">0.19505604496225715</span><span class="p">,</span>
                <span class="nt">&quot;saturation&quot;</span><span class="p">:</span> <span class="mf">0.3984375</span><span class="p">,</span>
                <span class="nt">&quot;blurriness&quot;</span><span class="p">:</span> <span class="mf">0.35999999940395355</span>
            <span class="p">},</span>
            <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;age&quot;</span><span class="p">:</span> <span class="mi">9292</span><span class="p">,</span>
                <span class="nt">&quot;gender&quot;</span><span class="p">:</span> <span class="mi">9860</span><span class="p">,</span>
                <span class="nt">&quot;eyeGlasses&quot;</span><span class="p">:</span> <span class="mf">0.959986999630928</span><span class="p">,</span>
                <span class="nt">&quot;emotions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;anger&quot;</span><span class="p">:</span> <span class="mf">0.4700000286102295</span><span class="p">,</span>
                    <span class="nt">&quot;disgust&quot;</span><span class="p">:</span> <span class="mf">0.5283599999999993</span><span class="p">,</span>
                    <span class="nt">&quot;fear&quot;</span><span class="p">:</span> <span class="mf">0.899993896484375</span><span class="p">,</span>
                    <span class="nt">&quot;happiness&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                    <span class="nt">&quot;neutral&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                    <span class="nt">&quot;sadness&quot;</span><span class="p">:</span> <span class="mf">0.7288925000000006</span><span class="p">,</span>
                    <span class="nt">&quot;surprise&quot;</span><span class="p">:</span> <span class="mf">0.799487956</span>
                <span class="p">},</span>
                <span class="nt">&quot;ethnicities&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;asian&quot;</span><span class="p">:</span> <span class="mf">0.40000000002328306</span><span class="p">,</span>
                    <span class="nt">&quot;indian&quot;</span><span class="p">:</span> <span class="mf">0.19921875</span><span class="p">,</span>
                    <span class="nt">&quot;caucasian&quot;</span><span class="p">:</span> <span class="mf">0.19999999995343387</span><span class="p">,</span>
                    <span class="nt">&quot;african&quot;</span><span class="p">:</span> <span class="mf">0.9497787896543741</span>
                <span class="p">},</span>
                <span class="nt">&quot;head_pose&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;yaw&quot;</span><span class="p">:</span> <span class="mi">9783</span><span class="p">,</span>
                    <span class="nt">&quot;pitch&quot;</span><span class="p">:</span> <span class="mi">1043</span><span class="p">,</span>
                    <span class="nt">&quot;roll&quot;</span><span class="p">:</span> <span class="mi">4871</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;9c152e8e-1ab4-4a6a-beaa-310a403236d2&quot;</span><span class="p">,</span>
            <span class="nt">&quot;rect&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;height&quot;</span><span class="p">:</span> <span class="mi">2066</span><span class="p">,</span>
                <span class="nt">&quot;width&quot;</span><span class="p">:</span> <span class="mi">7679</span><span class="p">,</span>
                <span class="nt">&quot;x&quot;</span><span class="p">:</span> <span class="mi">7418</span><span class="p">,</span>
                <span class="nt">&quot;y&quot;</span><span class="p">:</span> <span class="mi">1718</span>
            <span class="p">},</span>
            <span class="nt">&quot;rectISO&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;height&quot;</span><span class="p">:</span> <span class="mi">5746</span><span class="p">,</span>
                <span class="nt">&quot;width&quot;</span><span class="p">:</span> <span class="mi">5241</span><span class="p">,</span>
                <span class="nt">&quot;x&quot;</span><span class="p">:</span> <span class="mi">3633</span><span class="p">,</span>
                <span class="nt">&quot;y&quot;</span><span class="p">:</span> <span class="mi">6946</span>
            <span class="p">},</span>
            <span class="nt">&quot;score&quot;</span><span class="p">:</span> <span class="mf">0.7998046875</span><span class="p">,</span>
            <span class="nt">&quot;quality&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;light&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="nt">&quot;dark&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="nt">&quot;saturation&quot;</span><span class="p">:</span> <span class="mf">0.14697000000160187</span><span class="p">,</span>
                <span class="nt">&quot;blurriness&quot;</span><span class="p">:</span> <span class="mf">0.0</span>
            <span class="p">},</span>
            <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;age&quot;</span><span class="p">:</span> <span class="mi">6042</span><span class="p">,</span>
                <span class="nt">&quot;gender&quot;</span><span class="p">:</span> <span class="mi">1671</span><span class="p">,</span>
                <span class="nt">&quot;eyeGlasses&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="nt">&quot;emotions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;anger&quot;</span><span class="p">:</span> <span class="mf">0.6061999999999443</span><span class="p">,</span>
                    <span class="nt">&quot;disgust&quot;</span><span class="p">:</span> <span class="mf">0.6000000000058208</span><span class="p">,</span>
                    <span class="nt">&quot;fear&quot;</span><span class="p">:</span> <span class="mf">0.7442218899999489</span><span class="p">,</span>
                    <span class="nt">&quot;happiness&quot;</span><span class="p">:</span> <span class="mf">0.7999999999883585</span><span class="p">,</span>
                    <span class="nt">&quot;neutral&quot;</span><span class="p">:</span> <span class="mf">0.8320500031113625</span><span class="p">,</span>
                    <span class="nt">&quot;sadness&quot;</span><span class="p">:</span> <span class="mf">0.678575371158999</span><span class="p">,</span>
                    <span class="nt">&quot;surprise&quot;</span><span class="p">:</span> <span class="mf">0.2382965087890625</span>
                <span class="p">},</span>
                <span class="nt">&quot;ethnicities&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;asian&quot;</span><span class="p">:</span> <span class="mf">0.4390000000130385</span><span class="p">,</span>
                    <span class="nt">&quot;indian&quot;</span><span class="p">:</span> <span class="mf">0.2616399973630905</span><span class="p">,</span>
                    <span class="nt">&quot;caucasian&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                    <span class="nt">&quot;african&quot;</span><span class="p">:</span> <span class="mf">0.42949999996926636</span>
                <span class="p">},</span>
                <span class="nt">&quot;head_pose&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;yaw&quot;</span><span class="p">:</span> <span class="mi">2377</span><span class="p">,</span>
                    <span class="nt">&quot;pitch&quot;</span><span class="p">:</span> <span class="mi">7478</span><span class="p">,</span>
                    <span class="nt">&quot;roll&quot;</span><span class="p">:</span> <span class="mi">9020</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;3f2e3f0f-7734-4c3d-b442-51756ab947cc&quot;</span><span class="p">,</span>
            <span class="nt">&quot;rect&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;height&quot;</span><span class="p">:</span> <span class="mi">172</span><span class="p">,</span>
                <span class="nt">&quot;width&quot;</span><span class="p">:</span> <span class="mi">1627</span><span class="p">,</span>
                <span class="nt">&quot;x&quot;</span><span class="p">:</span> <span class="mi">8239</span><span class="p">,</span>
                <span class="nt">&quot;y&quot;</span><span class="p">:</span> <span class="mi">9473</span>
            <span class="p">},</span>
            <span class="nt">&quot;rectISO&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;height&quot;</span><span class="p">:</span> <span class="mi">2180</span><span class="p">,</span>
                <span class="nt">&quot;width&quot;</span><span class="p">:</span> <span class="mi">4183</span><span class="p">,</span>
                <span class="nt">&quot;x&quot;</span><span class="p">:</span> <span class="mi">1516</span><span class="p">,</span>
                <span class="nt">&quot;y&quot;</span><span class="p">:</span> <span class="mi">6737</span>
            <span class="p">},</span>
            <span class="nt">&quot;score&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="nt">&quot;quality&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;light&quot;</span><span class="p">:</span> <span class="mf">0.3326155988033861</span><span class="p">,</span>
                <span class="nt">&quot;dark&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="nt">&quot;saturation&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="nt">&quot;blurriness&quot;</span><span class="p">:</span> <span class="mf">0.399993896484375</span>
            <span class="p">},</span>
            <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;age&quot;</span><span class="p">:</span> <span class="mi">9631</span><span class="p">,</span>
                <span class="nt">&quot;gender&quot;</span><span class="p">:</span> <span class="mi">4255</span><span class="p">,</span>
                <span class="nt">&quot;eyeGlasses&quot;</span><span class="p">:</span> <span class="mf">0.14800000004470348</span><span class="p">,</span>
                <span class="nt">&quot;emotions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;anger&quot;</span><span class="p">:</span> <span class="mf">0.8346400000000003</span><span class="p">,</span>
                    <span class="nt">&quot;disgust&quot;</span><span class="p">:</span> <span class="mf">0.8824524100000417</span><span class="p">,</span>
                    <span class="nt">&quot;fear&quot;</span><span class="p">:</span> <span class="mf">0.125</span><span class="p">,</span>
                    <span class="nt">&quot;happiness&quot;</span><span class="p">:</span> <span class="mf">0.5100021362304688</span><span class="p">,</span>
                    <span class="nt">&quot;neutral&quot;</span><span class="p">:</span> <span class="mf">0.8000000000000114</span><span class="p">,</span>
                    <span class="nt">&quot;sadness&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                    <span class="nt">&quot;surprise&quot;</span><span class="p">:</span> <span class="mf">0.19600000232458115</span>
                <span class="p">},</span>
                <span class="nt">&quot;ethnicities&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;asian&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                    <span class="nt">&quot;indian&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                    <span class="nt">&quot;caucasian&quot;</span><span class="p">:</span> <span class="mf">0.6448592804372311</span><span class="p">,</span>
                    <span class="nt">&quot;african&quot;</span><span class="p">:</span> <span class="mf">0.8060809000016889</span>
                <span class="p">},</span>
                <span class="nt">&quot;head_pose&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;yaw&quot;</span><span class="p">:</span> <span class="mi">6436</span><span class="p">,</span>
                    <span class="nt">&quot;pitch&quot;</span><span class="p">:</span> <span class="mi">2209</span><span class="p">,</span>
                    <span class="nt">&quot;roll&quot;</span><span class="p">:</span> <span class="mi">8882</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;exif&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;artist&quot;</span><span class="p">:</span> <span class="s2">&quot;margaret70&quot;</span><span class="p">,</span>
        <span class="nt">&quot;dateTime&quot;</span><span class="p">:</span> <span class="s2">&quot;1986-01-11T21:06:03&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<p>Error messages are returned in following format <a class="reference internal" href="handlers.html#server_error"><code class="xref json json-object docutils literal notranslate"><span class="pre">server_error</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.1">500 Internal Server Error</a> – internal server error</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="luna_api.app.rest_handlers.photo_handler.PhotoHandler.setAdditionalDataToAdminStatistic">
<code class="descname">setAdditionalDataToAdminStatistic</code><span class="sig-paren">(</span><em>adminStats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/luna_api/app/rest_handlers/photo_handler.html#PhotoHandler.setAdditionalDataToAdminStatistic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#luna_api.app.rest_handlers.photo_handler.PhotoHandler.setAdditionalDataToAdminStatistic" title="Permalink to this definition">¶</a></dt>
<dd><p>Set additional stats “count_faces”</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>adminStats</strong> – common stats</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">new admin stats</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="lists.html">Lists API</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="matching.html">Matching API</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, VisionLabs.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.9.
    </div>
  </body>
</html>